# üö® QUICK FIX: Failed to Fetch Error

## **üéØ SOFORT-DIAGNOSE:**

### **Option 1: Browser Console Test (EMPFOHLEN)**

```javascript
// 1. √ñffne Browo Koordinator App
// 2. Dr√ºcke F12 ‚Üí Console
// 3. Kopiere und f√ºhre aus:

const testConnection = async () => {
  console.log('üîç Testing Supabase Connection...');
  
  // Import Supabase
  const { createClient } = await import('https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm');
  
  // Your credentials
  const projectId = 'azmtojgikubegzusvhra';
  const anonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF6bXRvamdpa3ViZWd6dXN2aHJhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkzODQzOTEsImV4cCI6MjA3NDk2MDM5MX0.bls9aJ-M1Wi-387R9mveOuiQCkmVPjTc6IntZjM1YMk';
  
  const supabase = createClient(`https://${projectId}.supabase.co`, anonKey);
  
  // Test 1: Basic connection
  console.log('Test 1: Basic Connection...');
  const { data: users, error: userError } = await supabase
    .from('users')
    .select('id')
    .limit(1);
  
  if (userError) {
    console.error('‚ùå User query failed:', userError);
    return;
  }
  console.log('‚úÖ User query OK:', users);
  
  // Test 2: Video table
  console.log('Test 2: Video Table...');
  const { data: videos, error: videoError } = await supabase
    .from('video_content')
    .select('*')
    .order('created_at', { ascending: false });
  
  if (videoError) {
    console.error('‚ùå Video query failed:', videoError);
    console.error('Error details:', JSON.stringify(videoError, null, 2));
    return;
  }
  console.log('‚úÖ Videos found:', videos.length);
  console.log('üìã Videos:', videos);
  
  // Test 3: Organization filter
  console.log('Test 3: Organization Filter...');
  const orgId = '60f2a9c9-dc19-4edc-9491-900819649b4a';
  const { data: orgVideos, error: orgError } = await supabase
    .from('video_content')
    .select('*')
    .eq('organization_id', orgId)
    .order('created_at', { ascending: false });
  
  if (orgError) {
    console.error('‚ùå Org filter failed:', orgError);
    return;
  }
  console.log('‚úÖ Org videos found:', orgVideos.length);
  console.log('üìã Org videos:', orgVideos);
  
  // Summary
  console.log('\nüìä SUMMARY:');
  console.log(`Total videos: ${videos.length}`);
  console.log(`Videos for organization: ${orgVideos.length}`);
  
  if (orgVideos.length === 0 && videos.length > 0) {
    console.warn('‚ö†Ô∏è WARNING: Videos exist but none match organization!');
    console.warn('Videos without organization_id:');
    const noOrg = videos.filter(v => !v.organization_id);
    console.log(noOrg);
  }
};

// Run test
testConnection();
```

---

## **üìã ERWARTETE AUSGABE:**

### ‚úÖ **ERFOLG:**
```
üîç Testing Supabase Connection...
Test 1: Basic Connection...
‚úÖ User query OK: [{id: "..."}]
Test 2: Video Table...
‚úÖ Videos found: 2
üìã Videos: [...]
Test 3: Organization Filter...
‚úÖ Org videos found: 2
üìã Org videos: [...]

üìä SUMMARY:
Total videos: 2
Videos for organization: 2
```

### ‚ùå **FEHLER 1: Supabase Paused**
```
‚ùå User query failed: {
  message: "Project is paused"
}
```

**L√∂sung:**
1. Gehe zu: https://supabase.com/dashboard/project/azmtojgikubegzusvhra
2. Klicke "Resume Project"
3. Warte 30 Sekunden
4. Test erneut ausf√ºhren

---

### ‚ùå **FEHLER 2: Table doesn't exist**
```
‚ùå Video query failed: {
  code: "42P01",
  message: "relation \"video_content\" does not exist"
}
```

**L√∂sung:**
```sql
-- In Supabase SQL Editor:
-- Pr√ºfe ob Tabelle existiert:
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public' 
AND table_name LIKE '%video%';

-- Falls video_content fehlt, erstelle sie:
CREATE TABLE IF NOT EXISTS video_content (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  title text NOT NULL,
  description text,
  youtube_url text NOT NULL,
  category text,
  organization_id uuid REFERENCES organizations(id),
  created_by uuid REFERENCES users(id),
  created_at timestamptz DEFAULT now(),
  updated_at timestamptz DEFAULT now()
);

-- Enable RLS:
ALTER TABLE video_content ENABLE ROW LEVEL SECURITY;

-- Create policy:
CREATE POLICY "Users can view videos from their organization"
  ON video_content FOR SELECT
  USING (
    organization_id IN (
      SELECT organization_id FROM users WHERE id = auth.uid()
    )
  );
```

---

### ‚ùå **FEHLER 3: Column organization_id missing**
```
‚ùå Org filter failed: {
  code: "42703",
  message: "column video_content.organization_id does not exist"
}
```

**L√∂sung:**
```sql
-- In Supabase SQL Editor:
ALTER TABLE video_content 
ADD COLUMN IF NOT EXISTS organization_id uuid 
REFERENCES organizations(id);

-- Update existing videos:
UPDATE video_content
SET organization_id = (
  SELECT id FROM organizations WHERE is_default = true LIMIT 1
)
WHERE organization_id IS NULL;
```

---

### ‚ùå **FEHLER 4: RLS Policy blocking**
```
‚úÖ Videos found: 2
‚úÖ Org videos found: 0
‚ö†Ô∏è WARNING: Videos exist but none match organization!
```

**L√∂sung:**
```sql
-- Videos haben falsche organization_id!
-- Fix mit SQL Script:
UPDATE video_content
SET organization_id = '60f2a9c9-dc19-4edc-9491-900819649b4a'
WHERE organization_id IS NULL 
   OR organization_id != '60f2a9c9-dc19-4edc-9491-900819649b4a';
```

---

## **üîß ALTERNATIVE: HTML Debug Tool**

Falls Browser Console nicht funktioniert:

1. √ñffne: `/v4.13.2_DEBUG_FAILED_TO_FETCH.html`
2. Direkt im Browser √∂ffnen (nicht in Figma Make)
3. Credentials eingeben:
   - **Project ID:** `azmtojgikubegzusvhra`
   - **Anon Key:** `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...` (siehe `/utils/supabase/info.tsx`)
   - **Org ID:** `60f2a9c9-dc19-4edc-9491-900819649b4a`
4. Klicke "Alle Tests ausf√ºhren"

---

## **üö® NUCLEAR OPTION: Disable RLS (NUR ZUM DEBUGGEN!)**

```sql
-- ACHTUNG: NUR ZUM TESTEN!
ALTER TABLE video_content DISABLE ROW LEVEL SECURITY;

-- Nach dem Test SOFORT wieder aktivieren:
ALTER TABLE video_content ENABLE ROW LEVEL SECURITY;
```

---

## **üìû N√ÑCHSTE SCHRITTE:**

1. **Browser Console Test ausf√ºhren** (siehe oben)
2. **Screenshot der Console Ausgabe** machen
3. **Mir den Screenshot zeigen**
4. Ich sage dir genau was zu tun ist!

**BITTE F√úHRE DEN CONSOLE TEST JETZT AUS UND ZEIGE MIR DIE AUSGABE!** üîç
