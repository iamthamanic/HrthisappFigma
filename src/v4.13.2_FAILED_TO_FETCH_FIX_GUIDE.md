# üö® v4.13.2: FAILED TO FETCH ERROR - FIX GUIDE

**Datum:** 2025-11-05  
**Status:** üîç DEBUGGING

---

## üéØ **QUICK START:**

### **SCHRITT 1: Debug Tool √∂ffnen**

1. √ñffne die Datei: `/v4.13.2_DEBUG_FAILED_TO_FETCH.html`
2. √ñffne sie **direkt im Browser** (nicht in Figma Make!)
3. Gib deine Credentials ein:
   - **Supabase Project ID**
   - **Supabase Anon Key**
   - **Organization ID:** `60f2a9c9-dc19-4edc-9491-900819649b4a`
4. Klicke **"Alle Tests ausf√ºhren"**

---

## üîç **M√ñGLICHE FEHLERQUELLEN:**

### **1. Supabase Paused**
```
ERROR: Failed to fetch
```

**L√∂sung:**
```
1. Gehe zu: https://supabase.com/dashboard
2. Pr√ºfe ob dein Projekt pausiert ist
3. Falls JA: Projekt reaktivieren
```

---

### **2. CORS Fehler**
```
ERROR: CORS policy blocked
```

**L√∂sung:**
```sql
-- In Supabase SQL Editor:
-- Keine SQL-√Ñnderung n√∂tig, CORS wird automatisch gehandhabt
```

**Backend Check:**
```bash
# Pr√ºfe ob Edge Functions deployed sind:
supabase functions list
```

---

### **3. RLS Fehler (Row Level Security)**
```
ERROR: new row violates row-level security policy
```

**L√∂sung:**
```sql
-- In Supabase SQL Editor:

-- 1. Pr√ºfe ob RLS aktiviert ist:
SELECT schemaname, tablename, rowsecurity 
FROM pg_tables 
WHERE tablename = 'video_content';

-- 2. Pr√ºfe aktive Policies:
SELECT * FROM pg_policies 
WHERE tablename = 'video_content';

-- 3. TEMPOR√ÑR: Disable RLS f√ºr Debug (NUR ZUM TESTEN!)
ALTER TABLE video_content DISABLE ROW LEVEL SECURITY;

-- Nach dem Test SOFORT wieder aktivieren:
ALTER TABLE video_content ENABLE ROW LEVEL SECURITY;
```

---

### **4. Missing organization_id Spalte**
```
ERROR: column "organization_id" does not exist
```

**L√∂sung:**
```sql
-- Pr√ºfe ob Spalte existiert:
SELECT column_name, data_type 
FROM information_schema.columns 
WHERE table_name = 'video_content';

-- Falls fehlt, hinzuf√ºgen:
ALTER TABLE video_content 
ADD COLUMN IF NOT EXISTS organization_id uuid 
REFERENCES organizations(id);
```

---

### **5. Supabase Client Fehler**
```
ERROR: Invalid API key
```

**L√∂sung:**
```typescript
// Pr√ºfe in /utils/supabase/client.ts:

import { createClient } from '@supabase/supabase-js';

const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;
const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;

if (!supabaseUrl || !supabaseAnonKey) {
  console.error('‚ùå Supabase Credentials fehlen!');
  console.error('URL:', supabaseUrl);
  console.error('Key:', supabaseAnonKey ? 'EXISTS' : 'MISSING');
}
```

**Check .env Datei:**
```bash
# In Figma Make gibt es KEINE .env Datei!
# Credentials kommen aus:
/utils/supabase/info.tsx
```

---

### **6. Edge Function nicht deployed**
```
ERROR: Function not found
```

**L√∂sung:**
```bash
# Deploy BrowoKoordinator-Lernen:
cd supabase/functions/BrowoKoordinator-Lernen
supabase functions deploy BrowoKoordinator-Lernen --no-verify-jwt

# Test nach Deploy:
curl https://DEIN-PROJECT-ID.supabase.co/functions/v1/BrowoKoordinator-Lernen/health \
  -H "Authorization: Bearer DEIN-ANON-KEY"
```

---

## üß™ **MANUELLE TESTS:**

### **Test 1: Supabase Connection**
```javascript
// In Browser Console:
const { createClient } = await import('https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm');

const supabase = createClient(
  'https://DEIN-PROJECT-ID.supabase.co',
  'DEIN-ANON-KEY'
);

const { data, error } = await supabase.from('users').select('id').limit(1);
console.log('‚úÖ Connection:', data, error);
```

---

### **Test 2: Video Query**
```javascript
// In Browser Console (nach Test 1):
const { data, error } = await supabase
  .from('video_content')
  .select('*')
  .order('created_at', { ascending: false });

console.log('‚úÖ Videos:', data?.length, error);
console.log('üìã Data:', data);
```

---

### **Test 3: Organization Filter**
```javascript
// In Browser Console (nach Test 2):
const orgId = '60f2a9c9-dc19-4edc-9491-900819649b4a';

const { data, error } = await supabase
  .from('video_content')
  .select('*')
  .eq('organization_id', orgId)
  .order('created_at', { ascending: false });

console.log('‚úÖ Filtered Videos:', data?.length, error);
console.log('üìã Data:', data);
```

---

## üîß **COMMON FIXES:**

### **Fix 1: Supabase Credentials Check**

<function_calls>
<invoke name="file_search">
<parameter name="content_pattern">VITE_SUPABASE|supabase.*url|supabase.*key