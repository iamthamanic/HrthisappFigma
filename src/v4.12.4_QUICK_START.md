# ğŸš€ v4.12.4 - Mitarbeiter-Info-Karte - QUICK START

## âœ… Was ist neu?

Neben dem Mini-Kalender gibt es jetzt eine **Mitarbeiter-Info-Karte**, die detaillierte Informationen Ã¼ber den ausgewÃ¤hlten Mitarbeiter zeigt:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘¤ Max Mustermann                       â”‚
â”‚    max@example.com                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“ Standort: Berlin Mitte               â”‚
â”‚ ğŸ’¼ Abteilung: Produktion                â”‚
â”‚ ğŸ“ˆ Spezialisierung: Backstube           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Stunden im November              [92%]  â”‚
â”‚ Geleistet: 73.5h                        â”‚
â”‚ Soll: 80.0h                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Letzter Arbeitstag: 03.11.2025          â”‚
â”‚ Ausgestempelt um: 17:30 Uhr             â”‚
â”‚ Arbeitszeit: 8h 30m                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ã˜ SchichtlÃ¤nge: 8h 15m  [7T][14T][30T]  â”‚
â”‚ HÃ¤ufigster Start: 07:00 Uhr             â”‚
â”‚ Schichten gesamt: 5                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Features im Ãœberblick

| Feature                   | Beschreibung                                    |
|---------------------------|-------------------------------------------------|
| **Profil-Info**           | Standort, Abteilung, Spezialisierung          |
| **Monatsstunden**         | Soll/Ist mit Fortschrittsbalken                |
| **Letzte AktivitÃ¤t**      | Letzter Arbeitstag, Ausstempel-Zeit           |
| **Schicht-Analyse**       | Durchschnitt Ã¼ber 7/14/30 Tage (filterbar!)  |
| **Empty State**           | Platzhalter wenn kein Mitarbeiter ausgewÃ¤hlt  |

---

## ğŸ¯ Wie benutzt man es?

### **Schritt 1: Zur Schichtplanung navigieren**
```
Dashboard â†’ Schichtplanung Tab
```

### **Schritt 2: Mitarbeiter auswÃ¤hlen**
```
Linke Sidebar â†’ Mitarbeiter-Liste â†’ Klick auf Mitarbeiter
```

### **Schritt 3: Info-Karte prÃ¼fen**
```
Oben rechts neben dem Mini-Kalender â†’ Alle Details werden angezeigt!
```

### **Schritt 4: Zeitraum-Filter Ã¤ndern (optional)**
```
Unten in der Info-Karte â†’ Buttons: [7T] [14T] [30T]
â†’ Durchschnittliche Schichtzeiten werden neu berechnet
```

---

## ğŸ“Š Was wird angezeigt?

### **1. Monatsstunden**
- âœ… **Geleistet**: Summe aller abgestempelten Arbeitszeiten im aktuellen Monat
- âœ… **Soll (bisher)**: Erwartete Stunden bis zum heutigen Tag
- âœ… **Monatssoll gesamt**: Gesamtstunden fÃ¼r den ganzen Monat
- âœ… **Prozentsatz**: (Geleistet / Soll bisher) Ã— 100%

**Farben:**
- ğŸŸ¢ GrÃ¼n (â‰¥90%): Ziel erreicht
- ğŸŸ¡ Gelb (70-89%): Im Plan
- ğŸ”´ Rot (<70%): RÃ¼ckstand

### **2. Letzte AktivitÃ¤t**
- âœ… **Letzter Arbeitstag**: Datum der letzten Zeiterfassung
- âœ… **Ausgestempelt um**: Uhrzeit des Clock-Out
- âœ… **Arbeitszeit**: Dauer der letzten Arbeitsschicht

### **3. Durchschnittliche Schichtzeiten**
- âœ… **Ã˜ SchichtlÃ¤nge**: Durchschnitt aller Schichten im Zeitraum
- âœ… **HÃ¤ufigster Start**: Most common Start-Zeit
- âœ… **Schichten gesamt**: Anzahl Schichten im gewÃ¤hlten Zeitraum

---

## ğŸ§ª Quick Test

### **Test 1: Empty State**
1. Ã–ffne Schichtplanung
2. WÃ¤hle KEINEN Mitarbeiter aus
3. **Erwartung:** Info-Karte zeigt "Bitte Mitarbeiter:in auswÃ¤hlen"

### **Test 2: Mitarbeiter-Auswahl**
1. Klicke auf einen Mitarbeiter in der Liste
2. **Erwartung:** Info-Karte zeigt alle Daten des Mitarbeiters

### **Test 3: Zeitraum-Filter**
1. WÃ¤hle einen Mitarbeiter aus
2. Klicke auf [14T] Button
3. **Erwartung:** Durchschnittliche Schichtzeiten werden fÃ¼r 14 Tage berechnet

### **Test 4: Monatsstunden**
1. WÃ¤hle Mitarbeiter mit Zeiterfassung aus
2. **Erwartung:** Geleistete Stunden werden angezeigt
3. **Erwartung:** Fortschrittsbalken zeigt Prozentsatz

---

## ğŸ”§ Troubleshooting

### **Problem: Info-Karte zeigt "Keine AktivitÃ¤ten"**

**Ursache:** Mitarbeiter hat keine `work_sessions` im aktuellen Monat

**LÃ¶sung:**
```sql
-- Check: Hat der User work_sessions?
SELECT * FROM work_sessions
WHERE user_id = 'USER_ID'
  AND clock_in >= date_trunc('month', CURRENT_DATE)
ORDER BY clock_in DESC;
```

Falls leer â†’ User muss sich einstempeln!

---

### **Problem: Info-Karte zeigt "Keine Schichten"**

**Ursache:** Mitarbeiter hat keine `shifts` im gewÃ¤hlten Zeitraum

**LÃ¶sung:**
```sql
-- Check: Hat der User shifts?
SELECT * FROM shifts
WHERE user_id = 'USER_ID'
  AND date >= CURRENT_DATE - INTERVAL '7 days'
ORDER BY date DESC;
```

Falls leer â†’ Schichten mÃ¼ssen erstellt werden!

---

### **Problem: "Nicht zugewiesen" bei Standort/Abteilung**

**Ursache:** User hat keine `location_id` oder `department` gesetzt

**LÃ¶sung:**
```sql
-- Update User mit Standort und Abteilung
UPDATE users
SET 
  location_id = 'LOCATION_ID',
  department = 'Abteilungs-Name',
  specialization = 'Spezialisierung'
WHERE id = 'USER_ID';
```

---

### **Problem: Monatsstunden sind 0**

**Ursache:** User hat keine abgestempelten Sessions (clock_out = NULL)

**LÃ¶sung:**
```sql
-- Check: Gibt es offene Sessions?
SELECT * FROM work_sessions
WHERE user_id = 'USER_ID'
  AND clock_out IS NULL;
```

Falls ja â†’ User muss ausstempeln!

---

## ğŸ“± Mobile Ansicht

**Desktop (â‰¥1024px):**
```
[Mini-Kalender]  [Info-Karte]
[Mitarbeiter]    [Timeline]
```

**Mobile (<1024px):**
```
[Mini-Kalender]
[Info-Karte]
[Mitarbeiter]
[Timeline]
```

Alles wird **untereinander** gestacked!

---

## ğŸ¨ Anpassung

### **Farb-Schwellenwerte Ã¤ndern:**

In `/components/BrowoKo_EmployeeInfoCard.tsx`:

```typescript
// Aktuell:
percentage >= 90 ? 'bg-green-500' :   // GrÃ¼n ab 90%
percentage >= 70 ? 'bg-yellow-500' :  // Gelb ab 70%
'bg-red-500';                         // Rot unter 70%

// Anpassen auf z.B. strenger:
percentage >= 95 ? 'bg-green-500' :   // GrÃ¼n ab 95%
percentage >= 80 ? 'bg-yellow-500' :  // Gelb ab 80%
'bg-red-500';                         // Rot unter 80%
```

### **Default Zeitraum-Filter Ã¤ndern:**

```typescript
// Aktuell: 7 Tage
const [timeRange, setTimeRange] = useState<TimeRangeFilter>(7);

// Ã„ndern auf 14 Tage:
const [timeRange, setTimeRange] = useState<TimeRangeFilter>(14);
```

---

## ğŸš€ Next Steps

1. **Teste die Info-Karte** mit echten Mitarbeitern
2. **PrÃ¼fe die Berechnungen** (Stunden-Soll/Ist)
3. **Feedback sammeln** von HR / Schichtplanern
4. **Optional:** Weitere Features hinzufÃ¼gen (siehe v4.12.4_EMPLOYEE_INFO_CARD_COMPLETE.md)

---

## âœ… Zusammenfassung

**Was wurde implementiert:**
- âœ… Neue Komponente `BrowoKo_EmployeeInfoCard.tsx`
- âœ… Integration in `BrowoKo_ShiftPlanningTab.tsx`
- âœ… Live-Daten aus `work_sessions` und `shifts`
- âœ… Filterbare Zeitraum-Analyse (7/14/30 Tage)
- âœ… Empty State fÃ¼r nicht-ausgewÃ¤hlte User
- âœ… Responsive Design (Desktop & Mobile)

**Datenquellen:**
- `work_sessions` â†’ Monatsstunden, Letzte AktivitÃ¤t
- `shifts` â†’ Durchschnittliche Schichtzeiten
- `users` â†’ Profil-Informationen
- `locations` â†’ Standort-Namen

**Status:** âœ… **PRODUCTION READY**

---

**Version:** v4.12.4  
**Date:** November 2025  
**Type:** Feature Documentation
