# âœ… v4.12.7 - Info-Karte "Schicht zuweisen" Button & Selected State

## ğŸ¯ Ã„nderungen

### **1. "Schicht zuweisen" Button in Info-Karte**
- Button oben rechts im Header der Mitarbeiter-Informationen
- Nur sichtbar, wenn Mitarbeiter ausgewÃ¤hlt ist
- Ã–ffnet direkt den Schicht-Dialog

### **2. Selected State fÃ¼r Mitarbeiter-Boxen**
- AusgewÃ¤hlte Mitarbeiter-Box bleibt **blau umrandet**
- Visuelles Feedback welcher Mitarbeiter gerade angezeigt wird
- Selected State bleibt erhalten bis anderer Mitarbeiter gewÃ¤hlt wird

---

## ğŸ¨ Visuelle Ã„nderungen

### **Info-Karte Header:**

**VORHER:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mitarbeiter-Informationen       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Profil, Standort, etc.]        â”‚
```

**NACHHER:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mitarbeiter-Informationen       â”‚
â”‚                [Schicht zuweisen]â”‚ â† NEU!
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Profil, Standort, etc.]        â”‚
```

---

### **Mitarbeiter-Box Selected State:**

**Nicht ausgewÃ¤hlt:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ğŸ‘¤] Max Mustermannâ”‚  â† Grauer Border
â”‚    [Schicht zuwei.]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**AusgewÃ¤hlt:**
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ [ğŸ‘¤] Max Mustermannâ•‘  â† Blauer Border + Shadow
â•‘    [Schicht zuwei.]â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**Hover (nicht ausgewÃ¤hlt):**
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ [ğŸ‘¤] Anna Schmidt  â•‘  â† Blauer Border beim Hover
â•‘    [Schicht zuwei.]â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ’» Implementierung

### **1. BrowoKo_EmployeeInfoCard.tsx**

**Props erweitert:**
```tsx
interface EmployeeInfoCardProps {
  selectedUser: User | null;
  locations: Location[];
  onAssignShift?: (user: User) => void;  // âœ… NEU
}
```

**Header mit Button:**
```tsx
<CardHeader className="pb-3 flex-shrink-0">
  <div className="flex items-center justify-between">
    <CardTitle className="text-base">Mitarbeiter-Informationen</CardTitle>
    <Button
      variant="default"
      size="sm"
      className="h-8 text-xs"
      onClick={() => onAssignShift?.(selectedUser)}
    >
      Schicht zuweisen
    </Button>
  </div>
</CardHeader>
```

**Layout:**
- `flex items-center justify-between` â†’ Title links, Button rechts
- Button: `h-8 text-xs` â†’ Kompakt, passt zum Header
- `onClick` â†’ Ruft `onAssignShift` Callback auf

---

### **2. BrowoKo_DraggableUser.tsx**

**Props erweitert:**
```tsx
interface Props {
  user: User;
  hasShift?: boolean;
  isSelected?: boolean;  // âœ… NEU
  onClick?: () => void;
  onAssignShift?: (user: User) => void;
  getUserShifts?: (userId: string) => Promise<Shift[]>;
  onEditShift?: (shift: Shift) => void;
  onDeleteShift?: (shiftId: string) => void;
  locations?: Location[];
}
```

**Conditional Border:**
```tsx
<div 
  className={`border rounded-lg overflow-hidden bg-white cursor-pointer hover:border-blue-500 hover:shadow-md transition-all ${
    isSelected ? 'border-blue-500 shadow-md' : 'border-gray-200'
  }`}
  onClick={handleCardClick}
>
```

**Logik:**
- `isSelected = true` â†’ `border-blue-500 shadow-md` (blau + Schatten)
- `isSelected = false` â†’ `border-gray-200` (grau)
- Hover immer â†’ `hover:border-blue-500 hover:shadow-md`

---

### **3. BrowoKo_ShiftPlanningTab.tsx**

**Info-Karte mit Callback:**
```tsx
<BrowoKo_EmployeeInfoCard 
  selectedUser={selectedUserForInfo}
  locations={locations}
  onAssignShift={(user) => {
    setSelectedUserForShift(user);
    setSelectedUserForInfo(user);
    setEditShift(null);
    setCreateShiftDialogOpen(true);
  }}
/>
```

**DraggableUser mit isSelected:**
```tsx
<BrowoKo_DraggableUser
  key={user.id}
  user={user}
  hasShift={shifts.some(s => s.user_id === user.id)}
  isSelected={selectedUserForInfo?.id === user.id}  // âœ… NEU
  onClick={() => {
    setSelectedUserForInfo(user);
  }}
  onAssignShift={(user) => {
    setSelectedUserForShift(user);
    setSelectedUserForInfo(user);
    setEditShift(null);
    setCreateShiftDialogOpen(true);
  }}
  // ... rest
/>
```

**Selection Logic:**
```tsx
isSelected={selectedUserForInfo?.id === user.id}
```
- Vergleicht aktuelle User-ID mit ausgewÃ¤hlter User-ID
- `true` â†’ Box wird blau
- `false` â†’ Box bleibt grau

---

## ğŸ”„ User Flows

### **Flow 1: Mitarbeiter auswÃ¤hlen & Info anzeigen**

```
1. Click auf Mitarbeiter-Karte (z.B. "Max Mustermann")
   â”œâ”€â†’ Box wird BLAU umrandet âœ“
   â”œâ”€â†’ Info-Karte zeigt Max's Daten âœ“
   â””â”€â†’ "Schicht zuweisen" Button erscheint oben rechts âœ“

2. Click auf anderen Mitarbeiter (z.B. "Anna Schmidt")
   â”œâ”€â†’ Max's Box wird GRAU (deselected)
   â”œâ”€â†’ Anna's Box wird BLAU (selected) âœ“
   â”œâ”€â†’ Info-Karte zeigt Anna's Daten âœ“
   â””â”€â†’ Button bleibt sichtbar âœ“
```

---

### **Flow 2: Schicht zuweisen via Info-Karte Button**

```
1. Mitarbeiter ist ausgewÃ¤hlt (z.B. Max)
   â””â”€â†’ Box ist BLAU, Info-Karte zeigt Daten

2. Click auf "Schicht zuweisen" Button (oben rechts in Info-Karte)
   â”œâ”€â†’ Dialog Ã¶ffnet sich âœ“
   â”œâ”€â†’ Max ist vorausgewÃ¤hlt âœ“
   â”œâ”€â†’ Box bleibt BLAU âœ“
   â””â”€â†’ Info-Karte bleibt sichtbar âœ“

3. Schicht erstellen & speichern
   â””â”€â†’ Dialog schlieÃŸt, Box bleibt BLAU âœ“
```

---

### **Flow 3: Schicht zuweisen via Mitarbeiter-Box Button**

```
1. Mitarbeiter ist ausgewÃ¤hlt (z.B. Max)
   â””â”€â†’ Box ist BLAU

2. Click auf "Schicht zuweisen" Button (in Mitarbeiter-Box)
   â”œâ”€â†’ Dialog Ã¶ffnet sich âœ“
   â”œâ”€â†’ Max ist vorausgewÃ¤hlt âœ“
   â””â”€â†’ Box bleibt BLAU âœ“

3. Schicht erstellen
   â””â”€â†’ Dialog schlieÃŸt âœ“
```

---

## ğŸ¨ CSS States

### **Mitarbeiter-Box States:**

| State | Border | Shadow | Trigger |
|-------|--------|--------|---------|
| **Normal** | `border-gray-200` | None | Default |
| **Hover** | `border-blue-500` | `shadow-md` | Mouse over |
| **Selected** | `border-blue-500` | `shadow-md` | `isSelected=true` |
| **Selected + Hover** | `border-blue-500` | `shadow-md` | Both |

**Transition:**
```css
transition-all  /* Smooth border & shadow changes */
```

---

### **Info-Karte Button:**

**Styling:**
```tsx
variant="default"       // Blauer Hintergrund
size="sm"              // Kompakte GrÃ¶ÃŸe
className="h-8 text-xs"  // 32px HÃ¶he, kleine Schrift
```

**Position:**
```tsx
<div className="flex items-center justify-between">
  <CardTitle>...</CardTitle>    â† Links
  <Button>...</Button>          â† Rechts
</div>
```

---

## ğŸ“± Responsive Behavior

### **Desktop (â‰¥1024px):**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Filter  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚         â”‚ â”‚ Mitarbeiter-Info â”‚   â”‚
â”‚ â•”â•â•â•â•â•â•— â”‚ â”‚ [Schicht zuwei.] â”‚   â”‚
â”‚ â•‘ Max â•‘ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚ â•šâ•â•â•â•â•â• â”‚ â”‚ Profil           â”‚   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚ Standort: ...    â”‚   â”‚
â”‚ â”‚Anna â”‚ â”‚ â”‚ Abteilung: ...   â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†‘           â†‘
   Selected   Button sichtbar
```

### **Mobile (<1024px):**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚ â•‘ Max Muster. â•‘ â”‚ â† Selected (blau)
â”‚ â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Anna Schmidtâ”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mitarbeiter-Infoâ”‚
â”‚ [Schicht zuwei.]â”‚ â† Button auch mobile
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Profil          â”‚
â”‚ Standort: ...   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ UX Verbesserungen

### **Vorher:**
```
âŒ Nicht klar welcher Mitarbeiter gerade angezeigt wird
âŒ Schicht zuweisen nur via Mitarbeiter-Box Button
âŒ Keine persistente Auswahl-Anzeige
```

### **Nachher:**
```
âœ… BLAU umrandete Box zeigt klare Auswahl
âœ… Zwei Wege zum Schicht-Dialog:
   - Button in Mitarbeiter-Box
   - Button in Info-Karte (NEU!)
âœ… Selected State bleibt erhalten
âœ… Schnellerer Zugriff zum Schicht-Dialog
```

---

## ğŸ§ª Testing

### **Test 1: Selected State**
1. Ã–ffne Schichtplanung
2. Klicke auf Mitarbeiter A
3. **Erwartung:** Box A wird blau umrandet
4. **Erwartung:** Info-Karte zeigt A's Daten
5. **Erwartung:** Button "Schicht zuweisen" oben rechts
6. Klicke auf Mitarbeiter B
7. **Erwartung:** Box A wird grau
8. **Erwartung:** Box B wird blau
9. **Erwartung:** Info-Karte zeigt B's Daten

### **Test 2: Info-Karte Button**
1. WÃ¤hle einen Mitarbeiter
2. **Erwartung:** Button erscheint oben rechts
3. Klicke auf "Schicht zuweisen" Button
4. **Erwartung:** Dialog Ã¶ffnet sich
5. **Erwartung:** Mitarbeiter ist vorausgewÃ¤hlt
6. **Erwartung:** Box bleibt blau

### **Test 3: Hover vs Selected**
1. WÃ¤hle Mitarbeiter A (blau)
2. Hover Ã¼ber Mitarbeiter B
3. **Erwartung:** B wird blau (hover)
4. **Erwartung:** A bleibt blau (selected)
5. Mouse weg von B
6. **Erwartung:** B wird grau
7. **Erwartung:** A bleibt blau

### **Test 4: Empty State**
1. Ã–ffne Schichtplanung ohne Auswahl
2. **Erwartung:** Kein Mitarbeiter blau
3. **Erwartung:** Info-Karte zeigt "Bitte auswÃ¤hlen"
4. **Erwartung:** Button NICHT sichtbar

---

## ğŸ”§ Technical Details

### **State Management:**

```tsx
// In BrowoKo_ShiftPlanningTab.tsx
const [selectedUserForInfo, setSelectedUserForInfo] = useState<User | null>(null);
const [selectedUserForShift, setSelectedUserForShift] = useState<User | null>(null);
```

**Two separate states:**
- `selectedUserForInfo` â†’ Info-Karte Anzeige + Selected State
- `selectedUserForShift` â†’ Dialog Vorauswahl

**Why separate?**
- Info kann angezeigt werden ohne Dialog zu Ã¶ffnen
- Dialog kann geschlossen werden, Info bleibt
- Flexiblere UX

---

### **Conditional Rendering:**

**Info-Karte Button:**
```tsx
{selectedUser && (
  <Button onClick={() => onAssignShift?.(selectedUser)}>
    Schicht zuweisen
  </Button>
)}
```
- Nur wenn `selectedUser` existiert
- `onAssignShift?.(...)` â†’ Optional Chaining (sicher)

---

### **CSS Class Logic:**

```tsx
className={`
  border rounded-lg overflow-hidden bg-white 
  cursor-pointer 
  hover:border-blue-500 hover:shadow-md 
  transition-all 
  ${isSelected ? 'border-blue-500 shadow-md' : 'border-gray-200'}
`}
```

**Breakdown:**
1. Base classes: `border rounded-lg overflow-hidden bg-white cursor-pointer`
2. Hover: `hover:border-blue-500 hover:shadow-md`
3. Transition: `transition-all`
4. Conditional: `isSelected ? 'blau' : 'grau'`

---

## ğŸ“Š Visual Comparison

### **Mitarbeiter-Liste:**

**VORHER (v4.12.6):**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ğŸ‘¤] Max Mustermannâ”‚  â† Kein Selected State
â”‚    [Schicht zuwei.]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ğŸ‘¤] Anna Schmidt  â”‚  â† Beide gleich
â”‚    [Schicht zuwei.]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**NACHHER (v4.12.7):**
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ [ğŸ‘¤] Max Mustermannâ•‘  â† BLAU = Selected!
â•‘    [Schicht zuwei.]â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ğŸ‘¤] Anna Schmidt  â”‚  â† Grau = Nicht selected
â”‚    [Schicht zuwei.]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **Info-Karte:**

**VORHER (v4.12.6):**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mitarbeiter-Informationen       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Profil]                        â”‚
â”‚ Standort: Berlin                â”‚
â”‚ Abteilung: IT                   â”‚
â”‚ ...                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**NACHHER (v4.12.7):**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mitarbeiter-Informationen       â”‚
â”‚                [Schicht zuweisen]â”‚ â† NEU!
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Profil]                        â”‚
â”‚ Standort: Berlin                â”‚
â”‚ Abteilung: IT                   â”‚
â”‚ ...                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ Benefits

### **FÃ¼r HR / Schichtplaner:**
âœ… **Schnellerer Zugriff:** Button direkt in Info-Karte  
âœ… **Klarere Auswahl:** Blauer Border zeigt selected state  
âœ… **Zwei Optionen:** Schicht zuweisen via Box ODER Info-Karte  
âœ… **Persistente Anzeige:** Selected state bleibt erhalten  
âœ… **Bessere Ãœbersicht:** Immer klar welcher Mitarbeiter aktiv ist  

### **FÃ¼r UX:**
âœ… **Visuelles Feedback:** Selected state ist sofort erkennbar  
âœ… **Konsistentes Verhalten:** Hover + Selected beide blau  
âœ… **Flexible Interaktion:** Zwei Wege zum gleichen Ziel  
âœ… **Professionelles UI:** Klare visuelle Hierarchie  

---

## ğŸ“ Zusammenfassung

**Changed Files:**
- âœ… `/components/BrowoKo_EmployeeInfoCard.tsx` - Button im Header
- âœ… `/components/BrowoKo_DraggableUser.tsx` - Selected State
- âœ… `/components/BrowoKo_ShiftPlanningTab.tsx` - Props & Callbacks

**New Features:**
- âœ… "Schicht zuweisen" Button in Info-Karte (oben rechts)
- âœ… Blauer Border fÃ¼r ausgewÃ¤hlte Mitarbeiter-Box
- âœ… Selected State bleibt persistent erhalten

**Lines Changed:** ~15 (minimal, fokussiert)

**Impact:**
- ğŸ¨ **Visual:** Klarere Auswahl durch Selected State
- ğŸš€ **UX:** Schnellerer Zugriff via Info-Karte Button
- ğŸ“Š **Planning:** Bessere Ãœbersicht bei der Schichtplanung

---

**Version:** v4.12.7  
**Type:** UX Enhancement - Info Card Button & Selected State  
**Status:** âœ… **COMPLETE - PRODUCTION READY**
