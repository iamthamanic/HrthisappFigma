# v4.7.1 - QUICK SETUP

## âš ï¸ ACHTUNG: PersonalSettings.tsx ist korrupt!

Beim Refactoring ist die Datei korrupt geworden (doppelter Code).

## ğŸš€ LÃ–SUNG:

### **SCHRITT 1: SQL Migration ausfÃ¼hren**

```bash
# In Supabase SQL Editor kopieren und ausfÃ¼hren:
```

```sql
-- Migration 058: Special Regulations
ALTER TABLE users 
ADD COLUMN IF NOT EXISTS special_regulations JSONB DEFAULT '[]'::jsonb;

CREATE INDEX IF NOT EXISTS idx_users_special_regulations 
ON users USING GIN (special_regulations);

COMMENT ON COLUMN users.special_regulations IS 
'Array of special regulations for employee. Structure: {type, custom_description, notes}';

DO $$
BEGIN
  RAISE NOTICE 'âœ… Migration 058 completed successfully!';
  RAISE NOTICE '   - Added special_regulations (JSONB Array)';
END $$;
```

### **SCHRITT 2: PersonalSettings.tsx neu generieren**

Die Datei ist zu groÃŸ und korrupt. Bitte User fragen:

**"PersonalSettings.tsx ist beim Refactoring korrupt geworden. Soll ich die Datei komplett neu generieren mit den 3 Bereichen (Firmeninformationen, Vertragsinformationen, Sonderregelungen)?"**

## ğŸ“Š WAS IMPLEMENTIERT IST:

### âœ… **KOMPLETT:**
- SQL Migration 058 (special_regulations field)
- WorkInfoCards Component (`/components/HRTHIS_WorkInfoCards.tsx`)
- Permissions Hook (`/hooks/HRTHIS_useFieldPermissions.ts`)
- Calendar mit Jahren 1900-aktuell
- Emergency Contacts Card (User kann bearbeiten)
- Language Skills Card (User kann bearbeiten)

### âš ï¸ **TEILWEISE:**
- PersonalSettings.tsx (korrupt, muss neu generiert werden)

## ğŸ¯ NEUE STRUKTUR:

### **1. FIRMENINFORMATIONEN**
- Arbeits-E-Mail
- Position
- Abteilung
- Standort  
- Arbeitstelefonnummer

### **2. VERTRAGSINFORMATIONEN**
- BeschÃ¤ftigungsart
- Personalnummer
- Wochenstunden
- Eintrittsdatum
- Vertragsstatus
- Wiedereintrittsdatum
- Probezeit
- Pausenregelung
- Zeitmodell
- Rufbereitschaft

### **3. SONDERREGELUNGEN** (NEU!)
- Firmenwagen ğŸš—
- Fahrtkosten ğŸ’¶
- Urlaub ğŸ–ï¸
- Sonstige ğŸ“‹ (mit Freitextfeld)

## ğŸ“ DATENSTRUKTUR:

```json
special_regulations: [
  {
    "type": "company_car",
    "notes": "BMW 3er"
  },
  {
    "type": "other",
    "custom_description": "Home Office Equipment",
    "notes": "Laptop, Monitor"
  }
]
```

## âš¡ NÃ„CHSTE SCHRITTE:

1. âœ… SQL Migration ausfÃ¼hren (siehe oben)
2. â“ User fragen ob PersonalSettings neu generieren
3. â“ TeamMemberDetailsScreen auch updaten mit den 3 Cards?

